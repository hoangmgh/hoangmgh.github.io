<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>üìè How do we measure correlation between matrices ? | Hoang (Anh) Tran</title> <meta name="author" content="Hoang (Anh) Tran"> <meta name="description" content="Correlating matrices with RV coefficient and its application to correlating genotype arrays"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://hoangmgh.github.io/blog/2023/RV2/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> <script async src="https://www.googletagmanager.com/gtag/js?id={{%20site.google_analytics%20}}"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-1W7V2Y0MXW");</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Hoang¬†</span>(Anh)¬†Tran</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Bioinformatics<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Arts</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">üìè How do we measure correlation between matrices ?</h1> <p class="post-meta">October 18, 2023</p> <p class="post-tags"> <a href="/blog/2023"> <i class="fa-solid fa-calendar fa-sm"></i> 2023 </a> ¬† ¬∑ ¬† <a href="/blog/tag/math"> <i class="fa-solid fa-hashtag fa-sm"></i> math</a> ¬† <a href="/blog/tag/bioinformatics"> <i class="fa-solid fa-hashtag fa-sm"></i> bioinformatics</a> ¬† ¬† ¬∑ ¬† <a href="/blog/category/bioinformatics"> <i class="fa-solid fa-tag fa-sm"></i> Bioinformatics</a> ¬† </p> </header> <article class="post-content"> <div id="markdown-content"> <p><strong>1.Matrices inner-product</strong></p> <p>One day I woke up and asked: What if we want to define a metric to calculate the correlation between two matrices. How would that be possible? I think this can be a bit confusing, because we might not understand what we mean by ‚Äúcorrelation‚Äù.</p> <p>To clarify this questions, I think it is good to go back to our definition. In fact, I think it might be a bit more useful to use the inner-product definition becauset it might be more intuitive and leave room for generalization. The inner-product helps us to relate the formality of ‚Äúlength‚Äù, ‚Äúdistance‚Äù, and ‚Äúangle‚Äù in a defined space.</p> <p>For correlation between two vectors in \(\mathbb{R^n}\), we want to</p> <p>\begin{equation} \rho (x,y)= \frac{\langle x-\mu_x , y-\mu_y \rangle}{|x-\mu_x||y-\mu_y|}=\cos \theta_{x,y} \end{equation} In the Euclidean space, you can replace the inner-product by the dot-product and you now have the Pearson correlation: \begin{equation} \rho (x,y) = \frac{(x-\mu_x) \cdot (y -\mu_y) } { |x-\mu_x| |y-\mu_y|} \end{equation} Technically speaking, the correlation between \(x\) and \(y\) can represent the cosine of the angle between two vectors. It is defined as the inner-product of centered vectors \(x\) and \(y\), weighted down by their length (hence the denominator).</p> <p>The inner product is a great concept to think about ‚Äúrelative‚Äù distance because it can be defined as a mapping such that \(\langle x,x \rangle = \|x\|\) So in the case that \(x\) and \(y\) are identical, the norminator reaches its maximum value, and the correlation is always at most 0.</p> <p>Now we can even generalize the inner-product to be defined for matrices, as long as your definition plays along with the formal definition of an ‚Äúinner-product‚Äù.In the case of matrices space, a well-known inner-product is the following. Given matrices \(A\) and \(B \in \mathbb{R^{f \times n}}\): \begin{equation} \langle A , B \rangle = tr(AB^T) <br> \end{equation} This is saying that we calculate the dot products of vectors \(a_1 \cdot b_1\) , \(a_2 \cdot b_2\),‚Ä¶. and \(a_f \cdot b_f\). and summing them up, where \(a_i\) and \(b_i\) are the feature vectors of matrices \(A\) and \(B\) respectively. Thus the trace of \(AB^T\) gives us a ‚Äúsummary‚Äù value for how different two matrices are, by pairwise calculation of their feature vectors. A very important point I want to make is that dot product is a similarity measure, so the trace is summing up all the similarity.</p> <p>In the case that \(A=B\), we have \(\langle A ,B \rangle= tr(AA^T) = \|a_1\|+\|a_2\|+..+\|a_f\|\), which are the sum of the norms of feature columns in A. This is also similar to ‚Äúflattening‚Äù the matrix and treat it as the norm of the flattened vector. The trace inner-product is particularly useful, I believe, in the case that two matrices have the same size - same set of features, but different observations particularly.</p> <p><strong>2.RV coefficient</strong></p> <p>For two vectors \(A\) and \(B\) of different size, i.e. \(A \in \mathbb{R^{f \dots n_1}}\) and \(B \in \mathbb{R^{f \dots n_2}}\), there is no way that we can calculate \(\langle A B \rangle\). (Because these two don‚Äôt live on the same subspace). And so, we can ‚Äúdevise‚Äù a correlation between two matrices as: \begin{equation} \frac{\sum_{i=1}^f a_i b_i}{\sum_{i=1}^f |a_i|\sum_{i=1}^f |b_i|} \end{equation} In the case that \(A\) and \(B\) are of different size, but similiar set of features, we might want to calculate something like this:</p> <p>\begin{equation} \rho(A,B) = \frac{\langle AA^T, BB^T \rangle}{|AA^T||BB^T|} =\frac{tr(AA^TBB^T)}{|AA^T||BB^T|} \end{equation} Okay! So what this coefficient is measuring is basically the averaged similarity in the correlation pattern of the two matrices‚Äô feature sets. I then went on to try this measure on our genotype data.</p> </div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> ¬© Copyright 2023 Hoang (Anh) Tran. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?07b8786bab9b4abe90d10e61f7d12ff7" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-1W7V2Y0MXW"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-1W7V2Y0MXW");</script> <script async src="https://rum.cronitor.io/script.js"></script> <script>window.cronitor=window.cronitor||function(){(window.cronitor.q=window.cronitor.q||[]).push(arguments)},cronitor("config",{clientKey:""});</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>